{"version":3,"sources":["userController.js","songController.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"controllers.js","sourcesContent":["rhythmiq.controller('userController', ['$scope', '$sce', '$location', 'userModel', 'songModel', function($scope, $sce, $location, userModel, songModel){ \n\n    // console.log($scope.loggedin_username);\n\n    if(userModel.getAuthStatus()) {\n        $scope.username  = userModel.getUserObject()['username'];\n    }\n    \n    \n    if($location.$$path == '/profile'){\n        songModel.getUserSongs().then(function(response){\n            $scope.userSongs = null;\n            $scope.userSongs = response.data;\n            console.log($scope.userSongs);\n        }).catch(function(response) {\n        });\n    }\n\n    if($location.$$path == '/home'){\n        songModel.getNewSongs().then(function(response){\n            $scope.userSongs = null;\n            $scope.userSongs = response.data;\n            console.log($scope.userSongs);\n        }).catch(function(response) {\n        });\n    }\n\n    //populate cities select\n    if($location.$$path == '/register') {\n        userModel.getCityList().then(function(response){\n            $scope.data = {\n                cities: response.data,\n            };\n            $scope.selectedCity = $scope.data.cities[0];\n        }).catch(function(response) {\n        });\n    }\n\n    angular.extend($scope, {\n        // login: {\n        //     email_address: 'kkevinyee13@gmail.com',\n        //     password: 'Jesuszone#123'\n        // },\n\n        // register: {\n        //     email_address: 'kevin.yee19@gmail.com',\n        //     username: 'kevin.yee',\n        //     password: 'Jesuszone#123',\n        //     confirm_password: 'Jesuszone#123',\n        // },\n\n    });\n\n    angular.extend($scope, {\n        doLogin: function(loginForm) {\n            var user = {\n                email_address: $scope.login.email_address,\n                password: $scope.login.password\n            };\n            userModel.doLogin(user).then(function(){\n                $location.path('/home');\n            }).catch(function(response) {\n                alert('Incorrect email or password!');\n            });\n        },\n\n        doRegister: function(registerForm) {\n            var user = {\n                email_address: $scope.register.email_address,\n                username: $scope.register.username,\n                password: $scope.register.password,\n                confirm_password: $scope.register.confirm_password,\n                date_of_birth: $scope.register.date_of_birth,\n                city_id: $scope.selectedCity.city_id,\n            };\n\n            userModel.doRegister(user).then(function(){\n                var user = {\n                    email_address: $scope.register.email_address,\n                    password: $scope.register.password\n                };\n                alert('Registration Successful! Click okay to login.');\n                $location.path('/login');\n                // userModel.doLogin(user).then(function(){\n                //     $location.path('/home');\n                // }).catch(function(response) {\n                // });\n\n            }).catch(function(response) {\n                var error = '';\n                angular.forEach(response.data, function(value, key) {\n                   error = error + value + '<br>';\n                });\n                $scope.register.error = error;\n                $scope.showerror = true;\n            });\n        },\n\n        playSong: function(userSong) {\n            // myPlaylist.pause();\n            // myPlaylist.remove();\n            var index = -1;\n            for(var i in $scope.userSongs) {\n\n                var item = $scope.userSongs[i];   \n                if(userSong.song_title == item.song_title) {\n                    index = i;\n                }\n                myPlaylist.add({ \n                    title : item.song_title,\n                    artist  : item.username,\n                    mp3 : \"https://s3-ap-southeast-2.amazonaws.com/rhythmiq/\" + item.song_file_name\n                });\n            }\n            console.log(myPlaylist);\n            console.log('song index is ' + index);\n            myPlaylist.play(parseInt(index));\n            \n        },\n\n        deleteSong: function(userSong) {\n            var r = confirm(\"Are you sure you want to remove this song?\");\n            if (r == true) {\n            songModel.deleteSong(userSong['song_id']).then(function(){\n                var index = $scope.userSongs.indexOf(userSong);\n                $scope.userSongs.splice(index, 1);  \n            }).catch(function(response) {\n                console.log(response.data);\n            });\n            } \n        },\n\n\n\n    });\n}]);","rhythmiq.controller('songController', ['$scope', '$sce', '$location', 'Upload', 'songModel', 'userModel', function($scope, $sce, $location, Upload, songModel, userModel){ \n\n    if(userModel.getAuthStatus()) {\n        $scope.username  = userModel.getUserObject()['username'];\n    }\n\n    //populate genres\n    if($location.$$path == '/upload') {\n        songModel.getGenreList().then(function(response){\n            $scope.data = {\n                genres: response.data,\n            };\n            $scope.selectedGenre = $scope.data.genres[0];\n        }).catch(function(response) {\n        });\n    }\n\n    angular.extend($scope, {\n    doSongUpload: function(uploadForm) {\n            Upload.upload({\n                url: baseUrl + '/api/v1/songs',\n                method: 'POST',\n                file: $scope.song_file,\n                data: {\n                    'song_title': $scope.upload_song_title,\n                    'gnre_id': $scope.selectedGenre.gnre_id,\n                }\n            }).then(function(response){\n                console.log(response.data);\n                $scope.song_file = null;                \n                $scope.upload_song_title = null;             \n                $scope.upload_success = 'Song has been successfully uploaded! Go to your profile to listen.'\n                $scope.showsuccess = true;\n                $scope.showerror = false;\n            }).catch(function(response) {\n                console.log(response.data)\n                var error = '';\n                angular.forEach(response.data, function(value, key) {\n                   error = error + value + '<br>';\n                });\n                $scope.upload_error = error;\n                $scope.showerror = true;\n            });\n        },\n\n    });\n\n}]);"]}